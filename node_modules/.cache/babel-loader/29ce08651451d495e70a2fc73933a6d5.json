{"ast":null,"code":"import \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport \"antd/es/date-picker/style\";\nimport _DatePicker from \"antd/es/date-picker\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"C:\\\\Users\\\\kaituo\\\\Downloads\\\\06Artikola-administrado-master\\\\src\\\\views\\\\Article\\\\Edit.js\";\nimport React, { Component, createRef } from 'react';\nimport E from 'wangeditor';\nimport { getArticleById, saveArticle } from \"../../requsets\";\nimport './edit.less';\nimport moment from 'moment';\n\nclass Edit extends Component {\n  constructor() {\n    super();\n\n    this.initEditor = () => {\n      this.editor = new E(this.editorRef.current);\n\n      this.editor.customConfig.onchange = html => {\n        this.formRef.current.setFieldsValue({\n          content: html\n        });\n      };\n\n      this.editor.create();\n    };\n\n    this.editorRef = createRef();\n    this.formRef = createRef(); // 由于 Form.create方法已经被移除， 所以选择这种来实现， 需在Form组件中挂载 formRef\n\n    this.state = {\n      isLoading: false\n    };\n  }\n\n  componentDidMount() {\n    this.initEditor();\n    console.log(this.props);\n    this.setState({\n      isLoading: true\n    });\n    getArticleById(this.props.match.params.id).then(resp => {\n      console.log(resp);\n      const {\n        id,\n        ...data\n      } = resp;\n      data.createAt = moment(data.createAt);\n      this.formRef.current.setFieldsValue(data);\n      this.editor.txt.html(data.content);\n    });\n    this.setState({\n      isLoading: false\n    });\n  }\n\n  render() {\n    const layout = {\n      labelCol: {\n        span: 6\n      },\n      wrapperCol: {\n        span: 12\n      }\n    };\n    const tailLayout = {\n      wrapperCol: {\n        offset: 6\n      }\n    };\n\n    const onFinish = values => {\n      this.setState({\n        isLoading: true\n      });\n      const data = Object.assign({}, values, {\n        createAt: values.createAt.valueOf()\n      });\n      console.log(data);\n      saveArticle(this.props.match.params.id, data).then(res => {\n        _message.success(res.msg);\n      }).finally(() => {\n        this.setState({\n          isLoading: false\n        });\n        this.props.history.push('/admin/article');\n      });\n    };\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(_Card, {\n      title: \"\\u6587\\u7AE0\\u7F16\\u8F91\",\n      bordered: false,\n      extra: React.createElement(_Button, {\n        onClick: this.props.history.goBack,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, \"\\u8FD4\\u56DE\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(_Spin, {\n      spinning: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(_Form, Object.assign({\n      ref: this.formRef\n    }, layout, {\n      name: \"basic\",\n      initialValues: {\n        remember: true\n      },\n      onFinish: onFinish,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(_Form.Item, {\n      label: \"\\u6807\\u9898\",\n      name: \"title\",\n      rules: [{\n        required: true,\n        message: '请输入标题!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u6807\\u9898\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    })), React.createElement(_Form.Item, {\n      label: \"\\u4F5C\\u8005\",\n      name: \"author\",\n      rules: [{\n        required: true,\n        message: '请输入作者名称!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      placeholder: \"\\u4F5C\\u8005\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    })), React.createElement(_Form.Item, {\n      label: \"\\u9605\\u8BFB\\u91CF\",\n      name: \"amount\",\n      rules: [{\n        required: true,\n        message: '请输入阅读量!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(_Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u9605\\u8BFB\\u91CF\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    })), React.createElement(_Form.Item, {\n      label: \"\\u53D1\\u5E03\\u65F6\\u95F4\",\n      name: \"createAt\",\n      rules: [{\n        required: true,\n        message: '请选择时间!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(_DatePicker, {\n      showTime: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    })), React.createElement(_Form.Item, {\n      label: \"\\u5185\\u5BB9\",\n      name: \"content\",\n      rules: [{\n        required: true,\n        message: '请输入内容!'\n      }],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"qf-editor\",\n      ref: this.editorRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    })), React.createElement(_Form.Item, Object.assign({}, tailLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(_Button, {\n      size: \"large\",\n      type: \"primary\",\n      htmlType: \"Submit\",\n      onClick: this.onFinish,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\\u4FEE\\u6539\"))))));\n  }\n\n}\n\nexport default Edit;","map":{"version":3,"sources":["C:/Users/kaituo/Downloads/06Artikola-administrado-master/src/views/Article/Edit.js"],"names":["React","Component","createRef","E","getArticleById","saveArticle","moment","Edit","constructor","initEditor","editor","editorRef","current","customConfig","onchange","html","formRef","setFieldsValue","content","create","state","isLoading","componentDidMount","console","log","props","setState","match","params","id","then","resp","data","createAt","txt","render","layout","labelCol","span","wrapperCol","tailLayout","offset","onFinish","values","Object","assign","valueOf","res","success","msg","finally","history","push","goBack","remember","required","message"],"mappings":";;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,SAA1B,QAA0C,OAA1C;AAUA,OAAOC,CAAP,MAAc,YAAd;AACA,SAAQC,cAAR,EAAwBC,WAAxB,QAA0C,gBAA1C;AACA,OAAO,aAAP;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAEA,MAAMC,IAAN,SAAmBN,SAAnB,CAA6B;AAE3BO,EAAAA,WAAW,GAAG;AACZ;;AADY,SASdC,UATc,GASD,MAAM;AACjB,WAAKC,MAAL,GAAc,IAAIP,CAAJ,CAAM,KAAKQ,SAAL,CAAeC,OAArB,CAAd;;AACA,WAAKF,MAAL,CAAYG,YAAZ,CAAyBC,QAAzB,GAAqCC,IAAD,IAAU;AAC5C,aAAKC,OAAL,CAAaJ,OAAb,CAAqBK,cAArB,CAAoC;AAClCC,UAAAA,OAAO,EAAEH;AADyB,SAApC;AAGD,OAJD;;AAKA,WAAKL,MAAL,CAAYS,MAAZ;AACD,KAjBa;;AAEZ,SAAKR,SAAL,GAAiBT,SAAS,EAA1B;AACA,SAAKc,OAAL,GAAed,SAAS,EAAxB,CAHY,CAGe;;AAC3B,SAAKkB,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAE;AADA,KAAb;AAGD;;AAYDC,EAAAA,iBAAiB,GAAG;AAClB,SAAKb,UAAL;AACAc,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAjB;AACA,SAAKC,QAAL,CAAc;AACZL,MAAAA,SAAS,EAAE;AADC,KAAd;AAGAjB,IAAAA,cAAc,CAAC,KAAKqB,KAAL,CAAWE,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzB,CAAd,CACGC,IADH,CACQC,IAAI,IAAI;AACZR,MAAAA,OAAO,CAACC,GAAR,CAAYO,IAAZ;AACA,YAAM;AAACF,QAAAA,EAAD;AAAK,WAAGG;AAAR,UAAgBD,IAAtB;AACAC,MAAAA,IAAI,CAACC,QAAL,GAAgB3B,MAAM,CAAC0B,IAAI,CAACC,QAAN,CAAtB;AACA,WAAKjB,OAAL,CAAaJ,OAAb,CAAqBK,cAArB,CAAoCe,IAApC;AACA,WAAKtB,MAAL,CAAYwB,GAAZ,CAAgBnB,IAAhB,CAAqBiB,IAAI,CAACd,OAA1B;AACD,KAPH;AAQA,SAAKQ,QAAL,CAAc;AACZL,MAAAA,SAAS,EAAE;AADC,KAAd;AAID;;AAEDc,EAAAA,MAAM,GAAG;AACP,UAAMC,MAAM,GAAG;AACbC,MAAAA,QAAQ,EAAE;AAACC,QAAAA,IAAI,EAAE;AAAP,OADG;AAEbC,MAAAA,UAAU,EAAE;AAACD,QAAAA,IAAI,EAAE;AAAP;AAFC,KAAf;AAIA,UAAME,UAAU,GAAG;AACjBD,MAAAA,UAAU,EAAE;AAACE,QAAAA,MAAM,EAAE;AAAT;AADK,KAAnB;;AAGA,UAAMC,QAAQ,GAAGC,MAAM,IAAI;AACzB,WAAKjB,QAAL,CAAc;AACZL,QAAAA,SAAS,EAAE;AADC,OAAd;AAGA,YAAMW,IAAI,GAAGY,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,MAAlB,EAA0B;AACrCV,QAAAA,QAAQ,EAAEU,MAAM,CAACV,QAAP,CAAgBa,OAAhB;AAD2B,OAA1B,CAAb;AAGAvB,MAAAA,OAAO,CAACC,GAAR,CAAYQ,IAAZ;AACA3B,MAAAA,WAAW,CAAC,KAAKoB,KAAL,CAAWE,KAAX,CAAiBC,MAAjB,CAAwBC,EAAzB,EAA6BG,IAA7B,CAAX,CACGF,IADH,CACSiB,GAAD,IAAS;AACb,iBAAQC,OAAR,CAAgBD,GAAG,CAACE,GAApB;AACD,OAHH,EAIGC,OAJH,CAIW,MAAM;AACb,aAAKxB,QAAL,CAAc;AACZL,UAAAA,SAAS,EAAE;AADC,SAAd;AAGA,aAAKI,KAAL,CAAW0B,OAAX,CAAmBC,IAAnB,CAAwB,gBAAxB;AACD,OATH;AAUD,KAlBD;;AAqBA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,KAAK,EAAC,0BADR;AAEE,MAAA,QAAQ,EAAE,KAFZ;AAGE,MAAA,KAAK,EACH;AACE,QAAA,OAAO,EAAE,KAAK3B,KAAL,CAAW0B,OAAX,CAAmBE,MAD9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAQE;AAAM,MAAA,QAAQ,EAAE,KAAKjC,KAAL,CAAWC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AACE,MAAA,GAAG,EAAE,KAAKL;AADZ,OAEMoB,MAFN;AAGE,MAAA,IAAI,EAAC,OAHP;AAIE,MAAA,aAAa,EAAE;AAACkB,QAAAA,QAAQ,EAAE;AAAX,OAJjB;AAKE,MAAA,QAAQ,EAAEZ,QALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOE,0BAAM,IAAN;AACE,MAAA,KAAK,EAAC,cADR;AAEE,MAAA,IAAI,EAAC,OAFP;AAGE,MAAA,KAAK,EAAE,CAAC;AAACa,QAAAA,QAAQ,EAAE,IAAX;AAAiBC,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKE;AAAO,MAAA,WAAW,EAAC,gCAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CAPF,EAcE,0BAAM,IAAN;AACE,MAAA,KAAK,EAAC,cADR;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,KAAK,EAAE,CAAC;AAACD,QAAAA,QAAQ,EAAE,IAAX;AAAiBC,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKE;AAAO,MAAA,WAAW,EAAC,cAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CAdF,EAqBE,0BAAM,IAAN;AACE,MAAA,KAAK,EAAC,oBADR;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,KAAK,EAAE,CAAC;AAACD,QAAAA,QAAQ,EAAE,IAAX;AAAiBC,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKE;AAAO,MAAA,WAAW,EAAC,sCAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CArBF,EA4BE,0BAAM,IAAN;AACE,MAAA,KAAK,EAAC,0BADR;AAEE,MAAA,IAAI,EAAC,UAFP;AAGE,MAAA,KAAK,EAAE,CAAC;AAACD,QAAAA,QAAQ,EAAE,IAAX;AAAiBC,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKE;AAAY,MAAA,QAAQ,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CA5BF,EAmCE,0BAAM,IAAN;AACE,MAAA,KAAK,EAAC,cADR;AAEE,MAAA,IAAI,EAAC,SAFP;AAGE,MAAA,KAAK,EAAE,CAAC;AAACD,QAAAA,QAAQ,EAAE,IAAX;AAAiBC,QAAAA,OAAO,EAAE;AAA1B,OAAD,CAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAME;AAAK,MAAA,SAAS,EAAC,WAAf;AAA2B,MAAA,GAAG,EAAE,KAAK7C,SAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,CAnCF,EA2CE,0BAAM,IAAN,oBAAe6B,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QACE;AAAQ,MAAA,IAAI,EAAC,OAAb;AAAqB,MAAA,IAAI,EAAC,SAA1B;AAAoC,MAAA,QAAQ,EAAC,QAA7C;AAAsD,MAAA,OAAO,EAAE,KAAKE,QAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCADF,CA3CF,CADF,CARF,CADF,CADF;AAiED;;AAvI0B;;AA0I7B,eAAenC,IAAf","sourcesContent":["import React, {Component, createRef} from 'react'\r\nimport {\r\n  Card,\r\n  Button,\r\n  Form,\r\n  Input,\r\n  DatePicker,\r\n  Spin,\r\n  message,\r\n} from 'antd'\r\nimport E from 'wangeditor'\r\nimport {getArticleById, saveArticle} from \"../../requsets\"\r\nimport './edit.less'\r\nimport moment from 'moment'\r\n\r\nclass Edit extends Component {\r\n\r\n  constructor() {\r\n    super()\r\n    this.editorRef = createRef()\r\n    this.formRef = createRef() // 由于 Form.create方法已经被移除， 所以选择这种来实现， 需在Form组件中挂载 formRef\r\n    this.state = {\r\n      isLoading: false\r\n    }\r\n  }\r\n\r\n  initEditor = () => {\r\n    this.editor = new E(this.editorRef.current)\r\n    this.editor.customConfig.onchange = (html) => {\r\n      this.formRef.current.setFieldsValue({\r\n        content: html\r\n      })\r\n    }\r\n    this.editor.create()\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.initEditor()\r\n    console.log(this.props)\r\n    this.setState({\r\n      isLoading: true\r\n    })\r\n    getArticleById(this.props.match.params.id)\r\n      .then(resp => {\r\n        console.log(resp)\r\n        const {id, ...data} = resp\r\n        data.createAt = moment(data.createAt)\r\n        this.formRef.current.setFieldsValue(data)\r\n        this.editor.txt.html(data.content)\r\n      })\r\n    this.setState({\r\n      isLoading: false\r\n    })\r\n\r\n  }\r\n\r\n  render() {\r\n    const layout = {\r\n      labelCol: {span: 6},\r\n      wrapperCol: {span: 12},\r\n    };\r\n    const tailLayout = {\r\n      wrapperCol: {offset: 6},\r\n    };\r\n    const onFinish = values => {\r\n      this.setState({\r\n        isLoading: true\r\n      })\r\n      const data = Object.assign({}, values, {\r\n        createAt: values.createAt.valueOf()\r\n      })\r\n      console.log(data)\r\n      saveArticle(this.props.match.params.id, data)\r\n        .then((res) => {\r\n          message.success(res.msg)\r\n        })\r\n        .finally(() => {\r\n          this.setState({\r\n            isLoading: false\r\n          })\r\n          this.props.history.push('/admin/article')\r\n        })\r\n    };\r\n\r\n\r\n    return (\r\n      <div>\r\n        <Card\r\n          title=\"文章编辑\"\r\n          bordered={false}\r\n          extra={\r\n            <Button\r\n              onClick={this.props.history.goBack}\r\n            >返回\r\n            </Button>}>\r\n          <Spin spinning={this.state.isLoading}>\r\n            <Form\r\n              ref={this.formRef}\r\n              {...layout}\r\n              name=\"basic\"\r\n              initialValues={{remember: true}}\r\n              onFinish={onFinish}\r\n            >\r\n              <Form.Item\r\n                label=\"标题\"\r\n                name=\"title\"\r\n                rules={[{required: true, message: '请输入标题!'}]}\r\n              >\r\n                <Input placeholder='请输入标题'/>\r\n              </Form.Item>\r\n              <Form.Item\r\n                label=\"作者\"\r\n                name=\"author\"\r\n                rules={[{required: true, message: '请输入作者名称!'}]}\r\n              >\r\n                <Input placeholder='作者'/>\r\n              </Form.Item>\r\n              <Form.Item\r\n                label=\"阅读量\"\r\n                name=\"amount\"\r\n                rules={[{required: true, message: '请输入阅读量!'}]}\r\n              >\r\n                <Input placeholder='请输入阅读量'/>\r\n              </Form.Item>\r\n              <Form.Item\r\n                label=\"发布时间\"\r\n                name=\"createAt\"\r\n                rules={[{required: true, message: '请选择时间!'}]}\r\n              >\r\n                <DatePicker showTime/>\r\n              </Form.Item>\r\n              <Form.Item\r\n                label=\"内容\"\r\n                name='content'\r\n                rules={[{required: true, message: '请输入内容!'}]}\r\n              >\r\n                {/* <Input placeholder='请输入阅读量' /> */}\r\n                <div className='qf-editor' ref={this.editorRef}></div>\r\n              </Form.Item>\r\n              <Form.Item {...tailLayout}>\r\n                <Button size='large' type=\"primary\" htmlType=\"Submit\" onClick={this.onFinish}>\r\n                  保存修改\r\n                </Button>\r\n              </Form.Item>\r\n            </Form>\r\n          </Spin>\r\n        </Card>\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Edit\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}